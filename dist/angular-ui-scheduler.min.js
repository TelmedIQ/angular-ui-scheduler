angular.module("angular-ui-scheduler",[]).constant("angular_ui_scheduler_useTimezone",!1),angular.module("angular-ui-scheduler").constant("angular_ui_scheduler_frequencyOptions",[{name:"None (run once)",value:"none",intervalLabel:""},{name:"Minute",value:"minutely",intervalLabel:"minute(s)"},{name:"Hour",value:"hourly",intervalLabel:"hour(s)"},{name:"Day",value:"daily",intervalLabel:"day(s)"},{name:"Week",value:"weekly",intervalLabel:"week(s)"},{name:"Month",value:"monthly",intervalLabel:"month(s)"},{name:"Year",value:"yearly",intervalLabel:"year(s)"}]).constant("angular_ui_scheduler_endOptions",[{name:"Never",value:"never"},{name:"After",value:"after"},{name:"On Date",value:"on"}]).constant("angular_ui_scheduler_occurrences",[{name:"first",value:1},{name:"second",value:2},{name:"third",value:3},{name:"fourth",value:4},{name:"last",value:-1}]).constant("angular_ui_scheduler_weekdays",[{name:"Sunday",value:"su"},{name:"Monday",value:"mo"},{name:"Tuesday",value:"tu"},{name:"Wednesday",value:"we"},{name:"Thursday",value:"th"},{name:"Friday",value:"fr"},{name:"Saturday",value:"sa"},{name:"Day",value:["mo","tu","we","th","fr","sa","su"]},{name:"Weekday",value:["mo","tu","we","th","fr"]},{name:"Weekend day",value:["sa","su"]}]).constant("angular_ui_scheduler_months",[{name:"January",value:1},{name:"February",value:2},{name:"March",value:3},{name:"April",value:4},{name:"May",value:5},{name:"June",value:6},{name:"July",value:7},{name:"August",value:8},{name:"September",value:9},{name:"October",value:10},{name:"November",value:11},{name:"December",value:12}]).controller("angularUiSchedulerCtrl",["$scope","$filter","$log","rRuleHelper","angular_ui_scheduler_useTimezone","angular_ui_scheduler_frequencyOptions","angular_ui_scheduler_endOptions","angular_ui_scheduler_occurrences","angular_ui_scheduler_weekdays","angular_ui_scheduler_months",function(e,r,t,n,a,u,s,l,c,o){function i(e,r){this.scope=e,this.useTimezone=a,this.requireFutureStartTime=r,this.getOptions=function(){var r={};return r.startDate=this.scope.schedulerUTCTime,r.frequency=this.scope.schedulerFrequency.value,r.interval=this.scope.schedulerInterval,"after"===this.scope.schedulerEnd.value&&(r.occurrenceCount=this.scope.schedulerOccurrenceCount),"on"===this.scope.schedulerEnd.value&&(r.endDate=moment(e.schedulerUTCTime).add(1,"d").toDate()),"weekly"===this.scope.schedulerFrequency.value?r.weekDays=this.scope.weekDays:"yearly"===this.scope.schedulerFrequency.value?"month"===this.scope.yearlyRepeatOption?(r.month=this.scope.yearlyMonth.value,r.monthDay=this.scope.yearlyMonthDay):(r.setOccurrence=this.scope.yearlyOccurrence.value,r.weekDays=this.scope.yearlyWeekDay.value,r.month=this.scope.yearlyOtherMonth.value):"monthly"===this.scope.schedulerFrequency.value&&("day"===this.scope.monthlyRepeatOption?r.monthDay=this.scope.monthDay:(r.setOccurrence=this.scope.monthlyOccurrence.value,r.weekDays=this.scope.monthlyWeekDay.value)),r},this.clearErrors=function(){this.scope.scheduler_weekDays_error=!1,this.scope.scheduler_endDt_error=!1,this.scope.resetStartDate(),this.scope.scheduler_endDt_error=!1,this.scope.scheduler_interval_error=!1,this.scope.scheduler_occurrenceCount_error=!1,this.scope.scheduler_monthDay_error=!1,this.scope.scheduler_yearlyMonthDay_error=!1},this.setDetails=function(){},this.getRRule=function(){var e=this.getOptions();return n.getRule(e)},this.getValue=function(){var r=this.getRRule(),t=this.getOptions();return{name:e.schedulerName,rrule:r.toString(),options:t}},this.setRRule=function(e){return this.clear(),n.setRule(e,this.scope)},this.setName=function(e){this.scope.schedulerName=e},this.clear=function(){this.clearErrors(),this.scope.scheduler_form&&this.scope.scheduler_form.schedulerName&&this.scope.scheduler_form.schedulerName.$setPristine(),this.scope.setDefaults()},this.setRequireFutureStartTime=function(e){this.requireFutureStartTime=e},this.getRequireFutureStartTime=function(){return this.requireFutureStartTime},this.setShowRRule=function(r){e.showRRule=r}}function h(e){var r=e.scope,t=e.requireFutureStartTime||!1;return r.schedulerShowTimeZone=a,r.setDefaults=function(){r.scheduleTimeChange(),r.scheduleRepeatChange()},r.scheduleTimeChange=function(){if(a){r.resetStartDate();try{r.schedulerUTCTime=moment(r.schedulerUTCTime).tz(r.schedulerTimeZone),r.scheduler_form_schedulerStartDt_error=!1,r.scheduler_startTime_error=!1}catch(e){r.startDateError("Provide a valid start date and time")}}else r.scheduler_startTime_error=!1,r.scheduler_form_schedulerStartDt_error=!1},r.resetError=function(e){r[e]=!1},r.scheduleRepeatChange=function(){r.schedulerFrequency&&""!==r.schedulerFrequency.value&&"none"!==r.schedulerFrequency.value?(r.schedulerInterval=1,r.schedulerShowInterval=!0,r.schedulerIntervalLabel=r.schedulerFrequency.intervalLabel):(r.schedulerShowInterval=!1,r.schedulerEnd=r.endOptions[0]),r.sheduler_frequency_error=!1},r.setWeekday=function(e,t){var n=r.weekDays.indexOf(t);n>=0?r.weekDays.splice(n,1):r.weekDays.push(t),$(e.target).blur(),r.scheduler_weekDays_error=!1},r.startDateError=function(e){r.scheduler_form_schedulerStartDt_error=e},r.resetStartDate=function(){r.scheduler_form_schedulerStartDt_error=""},r.schedulerEndChange=function(){r.schedulerOccurrenceCount=1},a&&(r.timeZones=moment.tz.names()),r.setDefaults(),new i(r,t)}e.frequencyOptions=u,e.endOptions=s,e.occurrences=l,e.weekdays=c,e.months=o,e.schedulerName="",e.weekDays=[],e.schedulerStartHour=function(r){return arguments.length?void(e.schedulerUTCTime=moment(e.schedulerUTCTime).hours(r).toDate()):e.schedulerUTCTime.getHours()},e.schedulerStartMinute=function(r){return arguments.length?void(e.schedulerUTCTime=moment(e.schedulerUTCTime).minutes(r).toDate()):e.schedulerUTCTime.getMinutes()},e.schedulerStartSecond=function(r){return arguments.length?void(e.schedulerUTCTime=moment(e.schedulerUTCTime).seconds(r).toDate()):e.schedulerUTCTime.getSeconds()},e.schedulerUTCTime=moment().toDate(),e.schedulerFrequency=e.frequencyOptions[0],e.schedulerShowEvery=!1,e.schedulerEnd=e.endOptions[0],e.schedulerInterval=1,e.schedulerOccurrenceCount=1,e.monthlyRepeatOption="day",e.monthDay=1,e.monthlyOccurrence=e.occurrences[0],e.monthlyWeekDay=e.weekdays[0],e.yearlyRepeatOption="month",e.yearlyMonth=e.months[0],e.yearlyMonthDay=1,e.yearlyWeekDay=e.weekdays[0],e.yearlyOtherMonth=e.months[0],e.yearlyOccurrence=e.occurrences[0],e.schedulerIsValid=!1,e.rrule_nlp_description="",e.rrule="",e.dateChoice="utc",e.occurrence_list=[],e.scheduler=h({scope:e,requireFutureStartTime:!1})}]),angular.module("angular-ui-scheduler").directive("angularUiScheduler",function(){return{restrict:"E",templateUrl:"angular-ui-scheduler/src/angularUiScheduler.html",controller:"angularUiSchedulerCtrl",link:function(e,r,t){}}}),angular.module("angular-ui-scheduler").factory("rRuleHelper",["angular_ui_scheduler_useTimezone","$log","$filter","angular_ui_scheduler_frequencyOptions","angular_ui_scheduler_weekdays",function(e,r,t,n,a){return{getRule:function(e){var t,n=e.startDate,a=e.frequency,u=e.interval,s=e.occurrenceCount,l=e.endDate,c=e.month,o=e.monthDay,i=e.weekDays,h=e.setOccurrence,d={};if(angular.isDate(n))d.dtstart=n;else try{d.dtstart=new Date(n)}catch(y){r.error("Date conversion failed. Attempted to convert "+n+" to Date. "+y.message)}if(a&&"none"!==a){if(d.freq=RRule[a.toUpperCase()],d.interval=u,i&&"string"==typeof i&&(d.byweekday=RRule[i.toUpperCase()]),i&&angular.isArray(i))for(d.byweekday=[],t=0;t<i.length;t++)d.byweekday.push(RRule[i[t].toUpperCase()]);if(void 0!==h&&null!==h&&(d.bysetpos=h),c&&(d.bymonth=c),o&&(d.bymonthday=o),s)d.count=s;else if(l)if(angular.isDate(l))d.until=l;else try{d.until=new Date(l)}catch(y){r.error("Date conversion failed. Attempted to convert "+l+" to Date. "+y.message)}}else d.freq=RRule.DAILY,d.interval=1,d.count=1;return new RRule(d)},setRule:function(r){function u(e,r){var t=_.find(e,function(e){var t=e.split(/=/)[0].toUpperCase();return t===r});return t?t.split(/=/)[1].toUpperCase():null}function s(e){var r=e.toLowerCase().split(/,/),t=_.find(a,function(e){var t=angular.isArray(e.value)?e.value:[e.value],n=_.difference(t,r),a=_.difference(r,t);return 0===n.length&&0===a.length});return t}function l(r,a){var l,c,o,h,d,y,m,p=r.split(/=/)[0].toUpperCase(),f=r.split(/=/)[1];if("NAME"===p&&(i.schedulerName=f),"FREQ"===p&&(c=f.toLowerCase(),i.schedulerFrequency=_.find(n,function(e){return i.schedulerIntervalLabel=e.intervalLabel,e.value===c}),!i.schedulerFrequency||!i.schedulerFrequency.name))throw"FREQ not found in list of valid options";if("INTERVAL"===p){if(!parseInt(f,10))throw"INTERVAL must contain an integer > 0";i.schedulerInterval=parseInt(f,10),i.schedulerShowInterval=!0}if("BYDAY"===p)if("WEEKLY"===u(a,"FREQ"))for(l=f.split(/,/),i.weekDays=[],o=0;o<l.length;o++){if(!_.contains(["SU","MO","TU","WE","TH","FR","SA"],l[o]))throw"BYDAY contains unrecognized day value(s)";i.weekDays.push(l[o].toLowerCase()),i["weekDay"+l[o].toUpperCase()+"Class"]="active"}else if("MONTHLY"===u(a,"FREQ")){if(i.monthlyRepeatOption="other",i.monthlyWeekDay=s(f),!i.monthlyWeekDay)throw"BYDAY contains unrecognized day value(s)"}else if(i.yearlyRepeatOption="other",i.yearlyWeekDay=s(f),!i.yearlyWeekDay)throw"BYDAY contains unrecognized day value(s)";if("BYMONTHDAY"===p){if(!(parseInt(f,10)&&parseInt(f,10)>0&&parseInt(f,10)<32))throw"BYMONTHDAY must contain an integer between 1 and 31";i.monthDay=parseInt(f,10),i.monhthlyRepeatOption="day"}if("DTSTART"===p&&(/\d{8}T\d{6}.*Z/.test(f)&&(f=f.replace(/(\d{4})(\d{2})(\d{2}T)(\d{2})(\d{2})(\d{2}.*$)/,function(e,r,t,n,a,u,s){return r+"-"+t+"-"+n+a+":"+u+":"+s.substr(0,2)+"Z"})),e?(h=new Date(f),d=t("schZeroPad")(h.getMonth()+1,2),y=t("schZeroPad")(h.getDate(),2),i.schedulerStartDt=d+"/"+y+"/"+h.getFullYear(),i.schedulerStartHour=t("schZeroPad")(h.getHours(),2),i.schedulerStartMinute=t("schZeroPad")(h.getMinutes(),2),i.schedulerStartSecond=t("schZeroPad")(h.getSeconds(),2),i.scheduleTimeChange()):(i.schedulerStartDt=f.replace(/T.*$/,"").replace(/(\d{4})-(\d{2})-(\d{2})/,function(e,r,t,n){return t+"/"+n+"/"+r}),m=f.replace(/^.*T/,""),i.schedulerStartHour=t("schZeroPad")(m.substr(0,2),2),i.schedulerStartMinute=t("schZeroPad")(m.substr(3,2),2),i.schedulerStartSecond=t("schZeroPad")(m.substr(6,2),2)),i.scheduleTimeChange()),"BYSETPOS"===p)if("YEARLY"===u(a,"FREQ")){if(i.yearlRepeatOption="other",i.yearlyOccurrence=_.find(i.occurrences,function(e){return e.value===parseInt(f,10)}),!i.yearlyOccurrence||!i.yearlyOccurrence.name)throw"BYSETPOS was not in the tokens of 1,2,3,4,-1"}else if(i.monthlyOccurrence=_.find(i.occurrences,function(e){return e.value===parseInt(f,10)}),!i.monthlyOccurrence||!i.monthlyOccurrence.name)throw"BYSETPOS was not in the tokens of 1,2,3,4,-1";if("COUNT"===p){if(!parseInt(f,10))throw"COUNT must be a valid integer > 0";i.schedulerEnd=i.endOptions[1],i.schedulerOccurrenceCount=parseInt(f,10)}if("UNTIL"===p&&(/\d{8}T\d{6}.*Z/.test(f)&&(f=f.replace(/(\d{4})(\d{2})(\d{2}T)(\d{2})(\d{2})(\d{2}.*$)/,function(e,r,t,n,a,u,s){return r+"-"+t+"-"+n+a+":"+u+":"+s.substr(0,2)+"Z"})),i.schedulerEnd=i.endOptions[2],e?(h=new Date(f),d=t("schZeroPad")(h.getMonth()+1,2),y=t("schZeroPad")(h.getDate(),2),i.schedulerEndDt=d+"/"+y+"/"+h.getFullYear()):i.schedulerEndDt=f.replace(/T.*$/,"").replace(/(\d{4})-(\d{2})-(\d{2})/,function(e,r,t,n){return t+"/"+n+"/"+r})),"BYMONTH"===p)if("YEARLY"===u(a,"FREQ")&&u(a,"BYDAY")){if(i.yearlRepeatOption="other",i.yearlyOtherMonth=_.find(i.months,function(e){return e.value===parseInt(f,10)}),!i.yearlyOtherMonth||!i.yearlyOtherMonth.name)throw"BYMONTH must be an integer between 1 and 12"}else if(i.yearlyOption="month",i.yearlyMonth=_.find(i.months,function(e){return e.value===parseInt(f,10)}),!i.yearlyMonth||!i.yearlyMonth.name)throw"BYMONTH must be an integer between 1 and 12";if("BYMONTHDAY"===p){if(!parseInt(f,10))throw"BYMONTHDAY must be an integer between 1 and 31";i.yearlyMonthDay=parseInt(f,10)}}function c(){if("weekly"===i.schedulerFrequency.name&&0===i.weekDays.length)throw"Frequency is weekly, but BYDAYS value is missing.";if(!i.schedulerStartDt)throw"Warning: start date was not provided"}if(!r)throw"No rule entered. Provide a valid RRule string.";var o=r.split(/;/);if(!angular.isArray(o))throw"No rule entered. Provide a valid RRule string.";for(var i={},h=0;h<o.length;h++)l(o[h],o);return c(),i}}}]),angular.module("angular-ui-scheduler").filter("schZeroPad",function(){return function(e,r){var t=(Math.pow(10,r)+"").replace(/^1/,"")+(e+"").trim();return t.substr(t.length-r)}});
//# sourceMappingURL=angular-ui-scheduler.min.js.map
